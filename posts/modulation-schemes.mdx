---
title: 'Modulation Schemes'
date: '2020-04-07'
description: 'The math behind common signal modulation schemes'
type: 'tech'
---

This application demonstrates various modulation schemes.

## Table of Contents
1. [The Signals](#the-signals)
2. [Amplitude Modulation](#amplitude-modulation)
3. [Phase Modulation](#phase-modulation)
4. [Frequency Modulation](#frequency-modulation)
5. [Integration](#integration)
    1. [Cosine](#cosine)
    2. [Sine](#sine)
    3. [Triangle](#triangle)
    4. [Sawtooth](#sawtooth)
6. [Shift Keying](#shift-keying)

<Image alt={`emission`} src={`/images/modulation-schemes/modulation_schemes_gui.jpg`} width={1041} height={613}  />

## The Signals

![a](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20\text{message%20signal:%20}m(t)%20=%20A_m%20cos%20(2%20\pi%20f_m%20t%20+%20\varphi_m))

![b](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20\text{carrier%20signal:%20}c(t)%20=%20A_c%20cos%20(2%20\pi%20f_c%20t))

## Amplitude Modulation

![c](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20s(t)%20=%20c(t)%20\times%20m(t))

![d](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20BW%20=%202f_m)

## Phase Modulation

![e](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20s(t)%20=%20cos%20(2%20\pi%20f_c%20+%20k_p%20m(t)))

>![f](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20BW=2f_m\left(\beta+1\right))
>
>Bandwidth for *shift keyed* signals
>
>![g](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20BW_{keying}=f_c%20+%20f_m%20-%20(f_c%20-%20f_m))


## Frequency Modulation

<p align="center">
<img src="https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20s(t)%20=%20A_c%20cos%20\left(2\pi%20f_ct+2\pi%20k_f\int_{0}^{t}m\left(\tau\right)d\tau\right))" title="{\lambda_1}={2L}\quad\quad\text{or}\quad\quad{f_1}=\frac{2L}{c}" />
</p>

Let's understand why...

For a given frequency modulated signal, the frequency is directly proportional to the magnitude of the modulating message such that any change in modulation has a linear effect on the resulting signal frequency. To show this, the instantaneous frequency is expressed as:


<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?f_i(t)%20=%20f_c%20+%20k_f%20m(t)"
title="f_i(t) = f_c + k_f m(t)"
/></p>

In musical terms, the instaneous frequency is merely the representation of tones we hear. The pitch of one's voice, for instance, or the note of a tuning fork. As the number of these tones we hear increase, so does the complexity of our equation describing the instantaneous frequency. In other words, the instantaneous frequency describes the mish-mash of frequencies captured by your ears, or say a measurement.

> In the field of photonics, lasers are used to create and transmit mono-tone (single-frequency) signals. In more complex cases that are more common, multimode lasers are also used, which require a bit more finesse in identifying the multiple frequencies and their various amplitudes composing the signal. In pulsed or chirped optical signal generators, instantaneous frequency can vary with time. That is, a frequency modulation.

Let's suppose for a moment the modulating signal was zero. The instantaneous frequency would be expressed solely by the carrier frequency:

<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?f_i(t)%20=%20f_c"
title="f_i(t) = f_c"
/></p>

To express a sinusoidal waveform at this frequency, we must first compute the angular frequency from the above expression. Normally, this is simply:

<p align="center">
        <img 
        src="https://latex.codecogs.com/svg.latex?\varphi_{i}(t)%20=2\pi%20f_c"
        title="\varphi_{i}(t) = 2\pi f_c"
        />
        <img 
        src="https://latex.codecogs.com/svg.latex?s(t)=\cos(\varphi_{i}(t))=\cos(2\pi%20f_c"
        title="\varphi_{i}(t) = 2\pi f_c"
        />
</p>


However, what really has happened is we have unconsciously computed the instantaneous phase (which is expressed in radians).

---

While instantaneous phase (and conversely instantaneous frequency) are not generally covered, the understanding of phase or frequency modulation requires explicit definition of these terms. As we explore these definitions further, our familiar understanding of trigonometric operation will also benefit from this imbued clarity. So, to understand instantaneous phase more, we first begin by defining a generalized expression:

<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?\varphi_i(t)%20\equiv%202%20\pi%20\int_0^t{f_i(\tau)%20d\tau}"
title="\varphi_i(t) \equiv 2 \pi \int_0^t{f_i(\tau) d\tau}"
/></p>

We compute the integral of our instantaneous frequency to arrive at our instantaneous phase, which is merely the sum of our frequency term over a period of time, in this case, t, and then mapped to the unit circle, which has a circumference of 2π.

Since our frequency is constant (scalar), the result is straightforward:

<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?\varphi_i(t)=2\pi%20f_c\cdot%20t"
title="\varphi_i(t) \equiv 2 \pi \int_0^t{f_i(\tau) d\tau}"
/></p>

Recall that our frequency has units of inverse time equal to the period of one traversal around the unit circle in seconds. Now, note the t term in the above expression. Let's rewrite the expression:

<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?\varphi_i(t)=2\pi%20\frac{t}{t_c}"
title="\varphi_i(t) \equiv 2 \pi \int_0^t{f_i(\tau) d\tau}"
/></p>

What has happened is we have defined a ratio which marks our traversal around the unit circle in *increments of phase*. So when t=0, our **instantaneous phase** is 0. When our watches have progressed to 50% of our period, our **instantaneous phase** is  π (or 180°) or half the unit circle.

Sinusoidal functions, such as cosine and sine, are trigonometric functions which only accept arguments of **instantaneous phase** because it *marks where along the unit circle they currently are*. Much like a clock on the wall, to know our time, we must know the position of the clock hands.

So when the frequency of FM signals is defined as the linear change with respect to the modulated amplitude - that is,

<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?f_i(t)%20=%20f_c%20+%20k_f%20m(t)"
title="f_i(t) = f_c + k_f m(t)]"
/></p>

we must compute the instantaneous phase first before we can make any use of trigonometric functions. Again, this is because trigonometric functions accept only arguments of angular frequency, aka the **instantaneous phase** marking where along the the unit circle they are.

---
Compute the instantaneous phase of the general expression

<p align="center"><img 
src="https://latex.codecogs.com/svg.latex?\varphi_{i}\left(t\right)=2\pi\int_{0}^{t}{f_i\left(\tau\right)}d\tau=2\pi\left(f_ct+k_f\int_{0}^{t}m\left(\tau\right)d\tau\right)"
title="\varphi_{i}\left(t\right)=2\pi\int_{0}^{t}{f_i\left(\tau\right)}d\tau=2\pi\left(f_ct+k_f\int_{0}^{t}m\left(\tau\right)d\tau\right)"
/></p>


Which defines the trigonometric argument for the frequency modulated waveform:

<p align="center">
<img 
src="https://latex.codecogs.com/svg.latex?s(t)%20=%20A_c%20cos%20(%20\varphi_i(t))%20"
title="s(t) = A_c cos ( s(t)=A_c \cos\left(\varphi_{i}\left(t\right)\right)"
/>
<img 
src="https://latex.codecogs.com/svg.latex?\boxed{s(t)%20=%20A_c%20cos%20\left(2\pi%20f_ct+2\pi%20k_f\int_{0}^{t}m\left(\tau\right)d\tau\right)}"
title="s(t)=A_c \cos\left(2 \pi f_ct + 2\pi k_f \int_{0}^{t}{m\left(\tau\right)d\tau}\right)"
/>
</p>

>![aa](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20\text{modulating%20index:%20}\beta=\frac{\Delta%20f}{f_m}=\frac{k_fA_m}{f_m})
>
>![bb](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20\boxed{BW=2f_m\left(\beta+1\right)}=2(\Delta%20f+f_m))
>
>Bandwidth for shift keyed signals
>
>![cc](https://latex.codecogs.com/png.image?\dpi{110}%20\bg_white%20BW_{keying}=2f_m\left(\frac{1}{T}+\beta%20f_m\right)+f_m)

## Integration
### Cosine
![dd](https://latex.codecogs.com/svg.latex?m\left(t\right)=A_m\cos{\left(2\pi%20f_mt+\varphi_m\right)})

![ee](https://latex.codecogs.com/svg.latex?M\left(t\right)=\frac{A_m}{\pi%20f_m}\sin{\left(\pi%20f_mt\right)}\cos{\left(\pi%20f_mt+\varphi_m\right)})

### Sine

![ff](https://latex.codecogs.com/svg.latex?m\left(t\right)=A_m\sin{\left(2\pi%20f_mt+\varphi_m\right)})

![gg](https://latex.codecogs.com/svg.latex?M\left(t\right)=\frac{A_m}{\pi%20f_m}\sin{\left(\pi%20f_mt\right)}\sin{\left(\pi%20f_mt+\varphi_m\right)})

**Note:** scaling to the appropriate time-base is required. If evaluating across N, divide M[n] by the sampling frequency.

### Triangle
![hh](https://latex.codecogs.com/svg.latex?T%20=%20\text{period%20length})

![ii](https://latex.codecogs.com/svg.latex?m\left(t\right)=\frac{2}{\pi}\sin^{-1}{\left[\sin{\left(\pi%20t\right)}\right]})

![jj](https://latex.codecogs.com/svg.latex?m\left(t\right)=\frac{4}{T}\left|\left(\left(t-\frac{T}{4}\right)\%20\mod\%20T\right)-\frac{T}{2}\right|-1)

![ll](https://latex.codecogs.com/svg.image?%5Cbg_white%20m(t)%20=%20%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%5Cfrac%7B4%7D%7BT%7Dt%20-%201%20&%20t%3CT/2%5C%5C%5C%20-%5Cfrac%7B4%7D%7BT%7Dt%5E2%20&plus;%203%20&%20t%5Cgeq%20T/2%5Cend%7Bmatrix%7D%5Cright.)

![mm](https://latex.codecogs.com/svg.image?%5Cbg_white%20M(t)%20=%20%5Cint_%7B0%7D%5E%7Bt%7D%7Bm%5Cleft(%5Ctau%5Cright)%20d%5Ctau%7D%20=%20%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%5Cfrac%7B2%7D%7BT%7Dt%5E2%20-%20t%20&%20t%3CT/2%5C%5C%5C%20-%5Cfrac%7B2%7D%7BT%7Dt%5E2%20&plus;%203t%20&%20t%5Cgeq%20T/2%5Cend%7Bmatrix%7D%5Cright.)

**Note:** scaling to the appropriate time-base is required. If evaluating across N, divide M[n] by the sampling frequency.

### Sawtooth
![nn](https://latex.codecogs.com/svg.latex?t%20=%20x%20\mod%20T)

![oo](https://latex.codecogs.com/svg.latex?m\left(t\right)=\frac{t}{T}%20=\frac{x%20\mod%20T}{T})

![pp](https://latex.codecogs.com/svg.latex?M\left(t\right)=\int_{0}^{t}m\left(\tau\right)d\tau=\int_{0}^{t}{\frac{\tau}{T}d\tau}=\boxed{\frac{1}{T}\left(x%20\mod%20T\right)^2-\left(x%20\mod%20T\right)})

**Note:** scaling to the appropriate time-base is required. If evaluating across N, divide M[n] by the sampling frequency.

### Square

![qq](https://latex.codecogs.com/svg.image?%5Cbg_white%20m(t)=%5Cbegin%7Bcases%7D1&%20%5Ctext%7B%20if%20%7D%20t%3CT/2%5C%5C-1&%20%5Ctext%7B%20if%20%7D%20t%20%5Cgeq%20T/2%20%5Cend%7Bcases%7D)

![rr](https://latex.codecogs.com/svg.image?%5Cbg_white%20M(t)=%5Cint_%7B0%7D%5E%7Bt%7D%7Bm(%5Ctau)d%5Ctau%7D=%5Cbegin%7Bcases%7D%20t%20&%20%5Ctext%7B%20if%20%7D%20t%3CT/2%20%5C%5C%20-t%20&%20%5Ctext%7B%20if%20%7D%20t%20%5Cgeq%20T/2%20%5Cend%7Bcases%7D)

**Note:** scaling to the appropriate time-base is required. If evaluating across N, divide M[n] by the sampling frequency.

### Shift Keying


```python
import numpy as np

fs = 100000 # sampling frequency
fm = 100    # modulating frequency
T = fs/fm   # samples per period

# repeat
mt = np.repeat(binary_message, T)[:N]

# or ravel
mt_ = np.ravel(np.matlib.repmat(binary_message, T, 1), order='F')[:N]

# or kronecher
array_ones = np.ones(T)
mt__ = np.kron(binary_message, array_ones)[:N]

# integral
Mt = x * (2 * m(t) - 1)
```

**Note:** scaling to the appropriate time-base is required. If evaluating across N, divide M[n] by the sampling frequency.

**Example:**
The number of samples contained in the buffer of your measurement window. In other words, the number of samples collected is defined by:

```python
N = 7
```

The number of samples contained in one period of the modulating frequency

```python
T = fs/fm = 2
```

The message being transmitted

```python
binary_message = [1, 0, 1, 1]
```
Message is repeated T number of times

```python
mt = [1, 1, 0, 0, 1, 1, 1, 1]
```
Depending on the number of samples available in the measurement buffer, m(t) may become truncated:

```python
mt = m(t)[:N] = 1, 1, 0, 0, 1, 1, 1]
```

If modulation scheme is Phase shift-keying (PSK):

```python
pi = np.pi
mt = pi * m(t) = [pi, pi, 0, 0, pi, pi, pi]
```
